# （仮）PyFight Online 仕様書

## プロジェクト名

(仮) PyFight Online

## 使用言語と環境

- Python 3.10以上
- Pygame CE (Community Edition)

## プロジェクトの目的

- Python/Pygameを用いた格闘ゲームの基礎習得。
- 1対1のローカル対戦およびオンライン対戦の実装。
- Windsurfを活用した効率的な開発フローの確立。

## ゲーム概要

- シンプルな2D対戦格闘（HP制、タイムリミットあり）。
- 基本的な操作（移動、ジャンプ、弱/強攻撃、ガード）。

## オンライン仕様

- Pythonの `socket` 通信または PodSixNet を使用した P2P / サーバークライアント方式。
- まずは同期方式（Delay-based）から着手する。

## 開発フェーズ

- Phase 1: ローカルでの2人操作と当たり判定の完成。
- Phase 2: キャラクター状態管理（State Machine）の洗練。
- Phase 3: 通信プロトコルの設計と同期テスト。

## 現在の進行状況（フェーズ1）

本セクションは、現時点の実装状況を仕様として追記する。

### 実装済み（抜粋）

- 対戦中の向き（`facing`）は相手位置を基準に自動更新
- 入力バッファによるコマンド検出
- 必殺技
  - 波動拳（弾）
  - 真空波動拳（多段ヒット弾・スーパー）
  - 突進（←↙↓+K 表記の技）
- 突進の仕様
  - 突進中の当たり判定（攻撃判定）
  - 突進終了後の硬直アニメーション（Action 6760 の 1〜3）
  - 突進中／硬直中は再突進不可（永久コンボ対策）
- UI
  - 対戦中 ESC メニューに「コマンドリスト」を追加
  - コマンドリストで技を選択すると右側にアニメーションプレビュー表示
  - コマンドリストからメニューへ戻る際、Action 181（0〜7）を再生し、約20F停止してから復帰
- 表示の正しさ
  - 真空波動拳の弾は、移動方向に応じて左右反転描画（1Pが相手より右側でも見た目の向きが一致）

### 通常技のキー割り当て（フェーズ1）

コマンドリストの表記は以下。

- U: 弱パンチ
- I: 中パンチ
- O: 強パンチ
- J: 弱キック
- K: 中キック
- L: 強キック

### ビルド（Windows exe）

- PyInstaller による exe ビルドをサポート
- 出力先
  - `build/` に exe を出力
  - `build/temp/` を作業ディレクトリに利用
- `.spec` 実行環境によって `__file__` が未定義になるケースがあるため、パス解決は `cwd` 基準で動作するように調整
- 詳細手順は `docs/exeビルド手順_PyInstaller_Windows.md` を参照
